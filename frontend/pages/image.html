<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Image Segmentation</title>
  <link rel="stylesheet" href="../styles.css" />
</head>

<body>

<div class="annotation-container">

  <div
  class="top-toolbar"
  style="
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 12px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    margin-bottom: 12px;
  "
  >
    <button class="tool-btn" onclick="nav('/')" title="è¿”å›é¦–é¡µ">ğŸ </button>

    <span style="opacity:0.4;">|</span>

    <button class="tool-btn active" id="btnCursor">ğŸ–±ï¸ Mask Selection</button>
    <button class="tool-btn" id="btnPolygon">â¬¢ Polygen</button>
    <button class="tool-btn" id="btnHighlight">ğŸ” Check</button>

    <span style="margin-left:auto;" id="currentFileName">Loading...</span>
  </div>


  <!-- ================= é¡¶éƒ¨å·¥å…·æ  ================= -->
  <div class="toolbar" style="margin-bottom:16px;">
    <button class="btn" onclick="nav('/')">â† Back</button>
    <span id="currentFileName" style="margin-left:16px;">Loading...</span>
    <button class="tool-btn" id="btnSaveNext">ğŸ’¾ Save & Next</button>
  </div>

  <!-- ================= ä¸»æ ‡æ³¨åŒºï¼ˆå·¦å³å¸ƒå±€ï¼‰ ================= -->
  <div
    class="annotation-row"
    style="
      display: flex;
      gap: 24px;
      align-items: flex-start;
    "
  >

    <!-- ================= å·¦ä¾§ï¼šSAM è‡ªåŠ¨åˆ†å‰² ================= -->
    <div
      class="image-wrapper"
      style="position: relative; display: inline-block;"
    >
      <!-- åŸå›¾ -->
      <img
        id="baseImage"
        style="display:block; max-width:800px;"
      />

      <!-- SAM overlay -->
      <img
        id="segOverlay"
        style="
          position:absolute;
          top:0; left:0;
          width:100%;
          height:100%;
          opacity:0.5;
          pointer-events:none;
        "
      />

      <!-- SAM / Polygon å…±ç”¨ç»˜åˆ¶å±‚ï¼ˆå·¦ä¾§æš‚åªç”¨äºç‚¹å‡»ï¼‰ -->
      <!-- <canvas
        id="draw-polygon"
        style="
          position:absolute;
          top:0; left:0;
          pointer-events:auto;
        "
      ></canvas> -->
    </div>

    <!-- ================= å³ä¾§ï¼šPolygon ç²¾ä¿® ================= -->
    <div
      id="polygonPanel"
      style="
        position: relative;
        display: block;
        width: 800px;
      "
    >
      <img
        id="polygonImage"
        style="display:block; width:100%;"
      />
    
      <canvas
        id="polygonCanvas"
        style="
          position:absolute;
          top:0;
          left:0;
          width:100%;
          height:100%;
          background: rgba(255,0,0,0.25); /* ğŸ‘ˆ çº¢è‰²æµ‹è¯•å±‚ */
          z-index: 10;
          pointer-events: auto;
        "
      ></canvas>
    </div>
  

  </div>

  <!-- ================= ä¸‹æ–¹ï¼šç»“æœå±•ç¤º ================= -->
  <div
    style="
      display:flex;
      gap:24px;
      align-items:flex-start;
      margin-top: 20px;
    "
  >
    <div style="margin-top:20px;">
      <h4>ğŸ§ª Result Preview</h4>
      <img
        id="samResultImage"
        style="
          display:none;
          max-width:800px;
          border:1px solid #333;
          margin-top:8px;
        "
      />
    </div>

    <div style="margin-top:20px;">
      <h4>ğŸ§ª Result Preview</h4>
      <img
        id="polygonResultImage"
        style="
          display:none;
          max-width:800px;
          border:1px solid #333;
          margin-top:8px;
        "
      />
    </div>
  </div>

</div>
<!-- ================= å³ä¾§ï¼šå·²æ ‡æ³¨åˆ—è¡¨ ================= -->
<div
  id="labelListPanel"
  style="
    position: fixed;
    top: 80px;
    right: 16px;
    width: 260px;
    background: #1a1d23;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 8px;
    padding: 12px;
    max-height: 80vh;
    overflow-y: auto;
  "
>
  <div
    class="label-panel-title"
    style="font-weight:bold; margin-bottom:8px;"
  >
    ğŸ§© Annotated
  </div>
  <ul
    id="labelList"
    style="list-style:none; padding:0; margin:0;"
  ></ul>
</div>

</body>
</html>
